# Web Application Penetration Testing Checklist

## Pre-Engagement and Information Gathering
1. **Define Scope and Goals**  
   - Confirm which domains, IPs, endpoints, and applications are in-scope.  
   - Understand the testing timeline and deliverables.  
   - Obtain written authorization for the testing.

2. **Reconnaissance**  
   - Identify hosted domains, subdomains, and directories (using tools like `amass`, `Sublist3r`, and `dirsearch`).  
   - Enumerate open ports and services with `Nmap`.  
   - Gather WHOIS information and review DNS records.  
   - Check for any public information leakage (e.g., search engine dorks, pastebin leaks).

3. **Application Mapping**  
   - Analyze the applicationâ€™s structure, including entry points, user roles, and workflows.  
   - Note key technologies in use: frameworks (Django, React, etc.), CMS (WordPress, Joomla), server versions (Apache, Nginx, etc.).  
   - Identify APIs and third-party integrations.

---

## Authentication and Session Management
4. **Test Authentication Mechanisms**  
   - Check for weak passwords and default credentials.  
   - Test for username enumeration vulnerabilities (e.g., distinct error messages for valid vs. invalid users).  
   - Assess multi-factor authentication (MFA) implementations.

5. **Review Session Management**  
   - Ensure secure cookies (`Secure`, `HttpOnly`, `SameSite`).  
   - Verify proper session expiration and logout mechanisms.  
   - Test for session fixation and session ID predictability.

---

## Input Validation and Sanitization
6. **Check for Injection Flaws**  
   - Test for SQL Injection (manual and automated using tools like `sqlmap`).  
   - Assess for Command Injection (e.g., via form inputs, file uploads).  
   - Look for XPath, LDAP, and NoSQL injection points.

7. **Validate Input Filtering**  
   - Verify input fields for proper length, data type, and format checks.  
   - Ensure user inputs are encoded before rendering in the browser (preventing Cross-Site Scripting, XSS).  
   - Test file upload functions for malicious file execution (e.g., uploading PHP shells).

---

## Access Control and Authorization
8. **Verify Access Controls**  
   - Test for IDOR (Insecure Direct Object References) by manipulating parameters.  
   - Check if roles and permissions are correctly enforced.  
   - Ensure restricted pages and resources are not accessible without proper privileges.

9. **Test Horizontal and Vertical Privilege Escalation**  
   - Use accounts with varying privileges (guest, user, admin) to identify access control issues.  
   - Attempt to escalate privileges by altering session tokens, parameters, or API endpoints.

---

## Business Logic Testing
10. **Evaluate Application Logic Flaws**  
    - Look for conditions that allow bypassing workflows (e.g., skipping payment steps, altering order quantities).  
    - Identify actions that can be repeated or manipulated to exploit discounts, refunds, or inventory.  
    - Test for race conditions and duplicate form submissions.

---

## Security Headers and Configurations
11. **Check for Proper Security Headers**  
    - Validate `Content-Security-Policy` (CSP) to mitigate XSS.  
    - Ensure `X-Frame-Options` is set to prevent clickjacking.  
    - Confirm `Strict-Transport-Security` (HSTS) is in place for HTTPS enforcement.

12. **Assess Configuration Files and Sensitive Information**  
    - Ensure sensitive files are not publicly accessible (`.git`, `.env`, `backup.zip`).  
    - Review server configuration for exposed version numbers and unnecessary modules.  
    - Test for directory listing vulnerabilities.

---

## API and Web Service Testing
13. **Examine API Endpoints**  
    - Test for broken object-level authorization (BOLA).  
    - Verify input validation on parameters sent to APIs.  
    - Check for excessive data exposure (e.g., returning sensitive user information).

14. **Assess Rate Limiting and DoS Protections**  
    - Try brute-forcing APIs to check for rate limits.  
    - Test if multiple invalid requests lead to server instability or resource exhaustion.

---

## Cryptographic and Sensitive Data Protection
15. **Ensure Proper Use of Encryption**  
    - Confirm HTTPS is enforced across all endpoints.  
    - Check for weak SSL/TLS ciphers and outdated protocols.  
    - Verify passwords and sensitive data are not stored in plaintext.

16. **Test for Information Disclosure**  
    - Scan for comments in HTML source code that reveal internal information.  
    - Check if stack traces, error messages, or debug information is exposed.  
    - Look for sensitive data in browser cache, autocomplete fields, or logs.

---

## Client-Side and Third-Party Security
17. **Test Cross-Origin Resource Sharing (CORS)**  
    - Ensure that CORS policies do not allow unauthorized domains.  
    - Verify the `Access-Control-Allow-Origin` header is properly configured.

18. **Check for Dependency and Library Vulnerabilities**  
    - Identify outdated JavaScript libraries and third-party plugins.  
    - Test if known vulnerabilities (e.g., CVEs) can be exploited via third-party components.

---

## Post-Exploitation and Reporting
19. **Confirm Findings with Proof of Concept (PoC)**  
    - Create reproducible test cases for identified vulnerabilities.  
    - Gather sufficient evidence, such as screenshots, request/response logs, and payloads.

20. **Provide Detailed Recommendations**  
    - For each finding, offer clear remediation steps.  
    - Prioritize issues based on impact and exploitability.  
    - Include references to industry standards (e.g., OWASP Top 10, NIST guidelines).